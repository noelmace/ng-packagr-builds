{"version":3,"file":"flatten.js","sourceRoot":"","sources":["../../../src/lib/flatten/flatten.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qCAA4C;AAC5C,qCAAwC;AACxC,uEAAmE;AA2BnE,uBAAoC,IAAiB;;QACnD,MAAM,CAAC,yBAAgB,CAAC;YACtB,UAAU,EAAE,IAAI,CAAC,WAAW;YAC5B,KAAK,EAAE,IAAI,CAAC,SAAS;YACrB,MAAM,EAAE,IAAI;YACZ,IAAI,EAAE,IAAI,CAAC,QAAQ;YACnB,cAAc,EAAE,IAAI,CAAC,cAAc;SACpC,CAAC,CAAC;IACL,CAAC;CAAA;AARD,sCAQC;AAED,sBAAmC,IAAiB;;QAClD,MAAM,CAAC,yBAAgB,CAAC;YACtB,SAAS,EAAE,4CAAoB;YAC/B,UAAU,EAAE,IAAI,CAAC,WAAW;YAC5B,KAAK,EAAE,IAAI,CAAC,SAAS;YACrB,MAAM,EAAE,KAAK;YACb,IAAI,EAAE,IAAI,CAAC,QAAQ;YACnB,GAAG,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,KAAK,EAAE;YACvB,YAAY,oBACP,IAAI,CAAC,YAAY,CACrB;YACD,cAAc,EAAE,IAAI,CAAC,cAAc;SACpC,CAAC,CAAC;IACL,CAAC;CAAA;AAbD,oCAaC;AAED,yBAAsC,SAAiB,EAAE,UAAkB;;QACzE,MAAM,CAAC,qBAAY,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;IAC7C,CAAC;CAAA;AAFD,0CAEC","sourcesContent":["import { rollupBundleFile } from './rollup';\r\nimport { minifyJsFile } from './uglify';\r\nimport { downlevelCodeWithTsc } from '../ts/downlevel-transformer';\r\nimport { DependencyList } from './external-module-id-strategy';\r\n\r\nexport interface FlattenOpts {\r\n  entryFile: string;\r\n  destFile: string;\r\n  flatModuleFile: string;\r\n\r\n  /** ECMAScript module ID defined by the FESM bundles. */\r\n  esmModuleId: string;\r\n\r\n  /** UMD ID defined by the UMD bundle. */\r\n  umdModuleId: string;\r\n\r\n  /** AMD ID defined in the UMD bundle. */\r\n  amdId?: string;\r\n\r\n  /** Map of external UMD module IDs (dependencies).  */\r\n  umdModuleIds?: { [key: string]: string };\r\n\r\n  /** A list of external dependencies that will not be embedded in the bundle. */\r\n  externals?: string[] | RegExp;\r\n\r\n  /** List of dependency which are found in package.json */\r\n  dependencyList: DependencyList;\r\n}\r\n\r\nexport async function flattenToFesm(opts: FlattenOpts): Promise<void> {\r\n  return rollupBundleFile({\r\n    moduleName: opts.esmModuleId,\r\n    entry: opts.entryFile,\r\n    format: 'es',\r\n    dest: opts.destFile,\r\n    dependencyList: opts.dependencyList\r\n  });\r\n}\r\n\r\nexport async function flattenToUmd(opts: FlattenOpts): Promise<void> {\r\n  return rollupBundleFile({\r\n    transform: downlevelCodeWithTsc,\r\n    moduleName: opts.umdModuleId,\r\n    entry: opts.entryFile,\r\n    format: 'umd',\r\n    dest: opts.destFile,\r\n    amd: { id: opts.amdId },\r\n    umdModuleIds: {\r\n      ...opts.umdModuleIds\r\n    },\r\n    dependencyList: opts.dependencyList\r\n  });\r\n}\r\n\r\nexport async function flattenToUmdMin(entryFile: string, outputFile: string): Promise<string> {\r\n  return minifyJsFile(entryFile, outputFile);\r\n}\r\n"]}