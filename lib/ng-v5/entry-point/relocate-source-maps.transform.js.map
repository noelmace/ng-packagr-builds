{"version":3,"file":"relocate-source-maps.transform.js","sourceRoot":"","sources":["../../../../src/lib/ng-v5/entry-point/relocate-source-maps.transform.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qDAAwE;AACxE,wDAA+D;AAC/D,sCAAsC;AACtC,oCAAkE;AAClE,oDAA4D;AAE/C,QAAA,2BAA2B,GAAc,gCAAoB,CAAC,CAAM,KAAK,EAAC,EAAE;IACvF,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,8BAAsB,EAAE,CAAmB,CAAC;IAC1E,MAAM,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC;IAErD,qCAAqC;IACrC,GAAG,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;IAEnC,MAAM,QAAQ,GAAG,0BAAiB,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IAC3E,MAAM,6BAAkB,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAE;QACxC,IAAI,WAAW,GAAG,IAAI,CAAC;QACvB,qCAAqC;QACrC,OAAO,WAAW,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE,CAAC;YACrC,WAAW,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QACzC,CAAC;QAED,MAAM,CAAC,QAAQ,QAAQ,IAAI,WAAW,EAAE,CAAC;IAC3C,CAAC,CAAC,CAAC;IAEH,MAAM,CAAC,KAAK,CAAC;AACf,CAAC,CAAA,CAAC,CAAC","sourcesContent":["import { Transform, transformFromPromise } from '../../brocc/transform';\r\nimport { relocateSourceMaps } from '../../sourcemaps/relocate';\r\nimport * as log from '../../util/log';\r\nimport { isEntryPointInProgress, EntryPointNode } from '../nodes';\r\nimport { getGlobForMapWork } from '../../sourcemaps/shared';\r\n\r\nexport const relocateSourceMapsTransform: Transform = transformFromPromise(async graph => {\r\n  const entryPoint = graph.find(isEntryPointInProgress()) as EntryPointNode;\r\n  const moduleId = entryPoint.data.entryPoint.moduleId;\r\n\r\n  // 4. SOURCEMAPS: RELOCATE ROOT PATHS\r\n  log.info('Relocating source maps');\r\n\r\n  const patterns = getGlobForMapWork(entryPoint.data.destinationFiles, true);\r\n  await relocateSourceMaps(patterns, path => {\r\n    let trimmedPath = path;\r\n    // Trim leading '../' path separators\r\n    while (trimmedPath.startsWith('../')) {\r\n      trimmedPath = trimmedPath.substring(3);\r\n    }\r\n\r\n    return `ng://${moduleId}/${trimmedPath}`;\r\n  });\r\n\r\n  return graph;\r\n});\r\n"]}