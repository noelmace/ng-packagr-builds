{"version":3,"file":"nodes.js","sourceRoot":"","sources":["../../../src/lib/ng-v5/nodes.ts"],"names":[],"mappings":"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","sourcesContent":["import * as ts from 'typescript';\r\nimport { Node } from '../brocc/node';\r\nimport { by, isInProgress, isDirty } from '../brocc/select';\r\nimport { NgEntryPoint } from '../ng-package-format/entry-point';\r\nimport { NgPackage } from '../ng-package-format/package';\r\nimport { TsConfig } from '../ts/tsconfig';\r\nimport { DestinationFiles } from '../ng-package-format/shared';\r\n\r\nexport const TYPE_NG_PACKAGE = 'application/ng-package';\r\nexport const TYPE_NG_ENTRY_POINT = 'application/ng-entry-point';\r\nexport const TYPE_STYLESHEET = 'text/css';\r\nexport const TYPE_TEMPLATE = 'text/html';\r\nexport const TYPE_TS_SOURCES = 'application/ts';\r\n\r\n/** A node that can be read through the `fs` api. */\r\nexport const URL_PROTOCOL_FILE = 'file://';\r\n\r\n/** A node that can be read through the `ts` compiler api. */\r\nexport const URL_PROTOCOL_TS = 'ts://';\r\n\r\n/** A node specific to angular. */\r\nexport const URL_PROTOCOL_NG = 'ng://';\r\n\r\nexport function isEntryPoint(node: Node): node is EntryPointNode {\r\n  return node.type === TYPE_NG_ENTRY_POINT;\r\n}\r\n\r\nexport function isPackage(node: Node): node is PackageNode {\r\n  return node.type === TYPE_NG_PACKAGE;\r\n}\r\n\r\nexport function isStylesheet(node: Node): node is StylesheetNode {\r\n  return node.type === TYPE_STYLESHEET;\r\n}\r\n\r\nexport function isTemplate(node: Node): node is TemplateNode {\r\n  return node.type === TYPE_TEMPLATE;\r\n}\r\n\r\nexport function isTypeScriptSources(node: Node): node is TypeScriptSourceNode {\r\n  return node.type === TYPE_TS_SOURCES;\r\n}\r\n\r\nexport function byEntryPoint() {\r\n  return by(isEntryPoint);\r\n}\r\n\r\nexport function isEntryPointInProgress() {\r\n  return by(isEntryPoint).and(isInProgress);\r\n}\r\n\r\nexport function isEntryPointDirty() {\r\n  return by(isEntryPoint).and(isDirty);\r\n}\r\n\r\nexport function isFileUrl(value: string): boolean {\r\n  return value.startsWith(URL_PROTOCOL_FILE);\r\n}\r\n\r\nexport function fileUrl(path: string): string {\r\n  return `${URL_PROTOCOL_FILE}${path}`;\r\n}\r\n\r\nexport function fileUrlPath(url: string): string {\r\n  if (url.startsWith(URL_PROTOCOL_FILE)) {\r\n    return url.substring(URL_PROTOCOL_FILE.length);\r\n  }\r\n}\r\n\r\nexport function ngUrl(path: string): string {\r\n  return `${URL_PROTOCOL_NG}${path}`;\r\n}\r\n\r\nexport function isTsUrl(value: string): boolean {\r\n  return value.startsWith(URL_PROTOCOL_TS);\r\n}\r\n\r\nexport function tsUrl(path: string): string {\r\n  return `${URL_PROTOCOL_TS}${path}`;\r\n}\r\n\r\nexport class EntryPointNode extends Node {\r\n  public readonly type = TYPE_NG_ENTRY_POINT;\r\n\r\n  data: {\r\n    destinationFiles: DestinationFiles;\r\n    entryPoint: NgEntryPoint;\r\n    tsConfig?: TsConfig;\r\n  };\r\n}\r\n\r\nexport class PackageNode extends Node {\r\n  public readonly type = TYPE_NG_PACKAGE;\r\n\r\n  data: NgPackage;\r\n}\r\n\r\nexport class StylesheetNode extends Node {\r\n  public readonly type = TYPE_STYLESHEET;\r\n\r\n  data: { content?: string };\r\n}\r\n\r\nexport class TemplateNode extends Node {\r\n  public readonly type = TYPE_TEMPLATE;\r\n\r\n  data: { content?: string };\r\n}\r\n\r\nexport class TypeScriptSourceNode extends Node {\r\n  public readonly type = TYPE_TS_SOURCES;\r\n\r\n  data: ts.TransformationResult<ts.SourceFile>;\r\n}\r\n"]}